name: Windows Spring Boot CI

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  build-and-run:
    runs-on: [self-hosted, windows]
    env:
      JAVA_HOME: 'C:\Program Files\Java\jdk-17'
      PATH: 'C:\Program Files\Java\jdk-17\bin;${{ env.PATH }}'

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Set up Maven
        uses: s4u/setup-maven-action@v1.11.0
        with:
          maven-version: '3.8.8'  # Adjust if using a different version

      - name: Build with Maven
        run: mvn clean install
        shell: cmd

      - name: Run Spring Boot App
        run: java -jar target\springboot-gym-html-app-github-ubuntu-1.0.0.jar
        shell: cmd

      - name: Success Message
        if: success()
        run: echo Spring Boot app is running locally!
        shell: cmd

      - name: Failure Message
        if: failure()
        run: echo Build failed!
        shell: cmd
