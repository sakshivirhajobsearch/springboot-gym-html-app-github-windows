name: Build and Run Spring Boot App on Windows

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  build-and-run:
    runs-on: windows-latest

    env:
      JAVA_HOME: 'C:\\Program Files\\Java\\jdk-17'

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
        with:
          ref: main

      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'

      - name: Build with Maven
        run: mvn clean install

      - name: Run Spring Boot JAR
        run: java -jar target/springboot-gym-html-app-1.0.0.jar

      - name: Notify Success
        if: success()
        run: echo "Spring Boot app is running locally!"

      - name: Test home.html
        run: |
        java -jar target/your-app.jar &
        Start-Sleep -Seconds 10
        curl http://localhost:8081/home.html
        shell: pwsh

      - name: Notify Failure
        if: failure()
        run: echo "Build failed!"
